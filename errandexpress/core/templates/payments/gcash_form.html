{% extends 'base_complete.html' %}
{% load static %}

{% block title %}GCash Payment - ErrandExpress{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-12 px-4">
    <div class="max-w-md mx-auto">
        <!-- Card Container -->
        <div class="bg-white rounded-lg shadow-xl overflow-hidden">
            <!-- Header -->
            <div class="bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-8 text-white">
                <div class="flex items-center justify-center mb-4">
                    <svg class="w-12 h-12" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z"/>
                    </svg>
                </div>
                <h1 class="text-2xl font-bold text-center">GCash Payment</h1>
                <p class="text-blue-100 text-center mt-2">â‚±{{ task.commission.amount|default:"2.00" }} System Fee</p>
            </div>

            <!-- Task Info -->
            <div class="bg-blue-50 px-6 py-4 border-b border-blue-200">
                <p class="text-sm text-gray-600">Task:</p>
                <p class="font-semibold text-gray-800 truncate">{{ task.title }}</p>
            </div>

            <!-- Form -->
            <form method="POST" class="p-6 space-y-4">
                {% csrf_token %}

                <!-- Full Name -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Full Name <span class="text-red-500">*</span>
                    </label>
                    <input 
                        type="text" 
                        name="fullname" 
                        value="{{ fullname }}"
                        placeholder="Juan Dela Cruz"
                        required
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition"
                    >
                    <p class="text-xs text-gray-500 mt-1">Your name as it appears in your GCash account</p>
                </div>

                <!-- Phone Number -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Phone Number <span class="text-red-500">*</span>
                    </label>
                    <input 
                        type="tel" 
                        name="phone" 
                        value="{{ phone }}"
                        placeholder="+63 9XX XXX XXXX"
                        required
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition"
                    >
                    <p class="text-xs text-gray-500 mt-1">Your registered GCash phone number</p>
                </div>

                <!-- Email -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Email Address <span class="text-red-500">*</span>
                    </label>
                    <input 
                        type="email" 
                        name="email" 
                        value="{{ email }}"
                        placeholder="juan@example.com"
                        required
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition"
                    >
                    <p class="text-xs text-gray-500 mt-1">For payment receipt and confirmation</p>
                </div>

                <!-- GCash Number (Optional) -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        GCash Number <span class="text-gray-400">(Optional)</span>
                    </label>
                    <input 
                        type="tel" 
                        name="gcash_number" 
                        value="{{ gcash_number }}"
                        placeholder="09XX XXX XXXX"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition"
                    >
                    <p class="text-xs text-gray-500 mt-1">Your GCash registered mobile number</p>
                </div>

                <!-- Info Box -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6">
                    <p class="text-xs text-gray-700">
                        <strong>ðŸ“± What happens next:</strong><br>
                        1. Click "Proceed to Payment"<br>
                        2. You'll be redirected to GCash<br>
                        3. Complete the payment<br>
                        4. Your chat will unlock automatically
                    </p>
                </div>

                <!-- Buttons -->
                <div class="flex gap-3 mt-6">
                    <a 
                        href="{% url 'task_detail' task.id %}"
                        class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition font-medium"
                    >
                        Cancel
                    </a>
                    <button 
                        type="submit"
                        class="flex-1 px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:shadow-lg transition font-medium"
                    >
                        ðŸ’³ Proceed to Payment
                    </button>
                </div>
            </form>

            <!-- Footer -->
            <div class="bg-gray-50 px-6 py-4 border-t border-gray-200">
                <p class="text-xs text-gray-500 text-center">
                    ðŸ”’ Your payment information is secure and processed by PayMongo
                </p>
            </div>
        </div>

        <!-- Help Text -->
        <div class="mt-6 bg-white rounded-lg shadow p-4">
            <p class="text-sm text-gray-600">
                <strong>Need help?</strong> Make sure your GCash account is active and has sufficient balance before proceeding.
            </p>
        </div>
    </div>
</div>

<!-- Messages -->
{% if messages %}
<div class="fixed top-4 right-4 z-50 space-y-2">
    {% for message in messages %}
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded shadow-lg">
        {{ message }}
    </div>
    {% endfor %}
</div>
{% endif %}
{% endblock %}
